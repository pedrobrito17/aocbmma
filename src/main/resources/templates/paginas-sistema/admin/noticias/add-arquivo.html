<!DOCTYPE html>
<html lang="pt" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{padrao/layout-admin-base}">

<head>
</head>

<body>
    <main layout:fragment="conteudo">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <br>
                    <h4><b>Adicionar arquivo</b></h4>
                    <hr>

                </div>
            </div>
            <div class="row">
                <div class="col-lg-10 offset-lg-1">

                    <!-- MENSAGEM DE SUCESSO -->
                    <div th:replace="padrao/mensagens-alerta :: mensagem-sucesso"></div>
                    <!-- MENSAGEM DE ERRO -->
                    <div th:replace="padrao/mensagens-alerta :: mensagem-erro"></div>


                    <form enctype="multipart/form-data" th:action="@{/admin/salvar-arquivo}" th:method="POST">

                        <div class="form-group">
                            <label for="arquivo">Arquivo</label>
                            <input class="form-control form-custom" name="arquivo" type="file" required>
                        </div>
                        <button type="submit" class="btn btn-danger btn-noticias float-right">SALVAR</button>
                    </form>

                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-12 col-lg-8 offset-lg-2">

                    <table class="table table-sm table-striped">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Nome do arquivo</th>
                                <th></th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="arquivo,id : ${arquivos}">
                                <td class="align-middle" th:text="${id.count}">1</td>
                                <td class="align-middle" th:text="${arquivo.nome_arquivo}"></td>
                                <td class="align-middle"> 
                                    
                                    <input type="text" th:value="'http://www.aocbmma.com.br'+${arquivo.path}" th:id="${arquivo.id}" hidden> 
                                    <button class="btn btn-sm btn-secondary btn-copiar" th:onclick=" 'copiarLink(' + ${arquivo.id} + ')' ">Copiar link</button>
                                
                                </td>
                                <td class="text-right align-middle">
                                    <a th:href="@{/admin/excluir-arquivo/{id}(id=${arquivo.id})}"><button class="btn btn-outline-danger btn-sm">Excluir</button></a>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </div>
        </div>
        <script th:src="@{js/popover.min.js}"></script>
        <script>
            function copiarLink(id) {
                var copyLink = document.getElementById(id).value;

                var input = document.createElement('input');
                input.setAttribute('value', copyLink);
                document.body.appendChild(input);
                input.select();
                var result = document.execCommand('copy');
                document.body.removeChild(input)

            }

            $('.btn-copiar').on('shown.bs.popover', function(){

                setTimeout(function(){
                    $('.btn-copiar').popover('hide');
                }, 1000);

            });

            $('.btn-copiar').popover({
                trigger: 'click',
                placement: 'top',
                content: 'Link copiado'
            });
        </script>
    </main>

</body>

</html>